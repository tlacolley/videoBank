{% extends 'video_bank/base.html'%}

{% block content %}


<div class="row">

      <!-- Post Content Column -->
      <div class="col-lg-8">

        <!-- Title -->
        <h1 class="mt-4">{{movie.title}}</h1>

        <!-- Author -->
        <p class="lead">
          by
          <a href="#">{{ movie.director }}</a>
        </p>

        <hr>

        <!-- Infos -->
        <div class="">

        <p>Realise : {{ movie.release_date }} </p>
        <p>Country : {{ movie.country }}</p>
    </div>
        <p>Length : {{ movie.length }}</p>
        <p>Actors : {{ movie.actors }}</p>

        <hr>

        <!-- Preview Image -->


        <!-- Post Content -->
        <p class="lead">{{ movie.synopsis }}</p>

        <hr>
        <a href="{{trailer_url}}"> Trailer </a>




      </div>

      <!-- Sidebar Widgets Column -->
      <div class="col-md-4">
        <!-- Manage Widget -->
          <div class="card my-4">
            <h5 class="card-header">Manage: </h5>
            <div class="card-body">
              <a href="{% url 'movie_update' movie.slug %}">Update</a>
              <a href="{% url 'movie_remove' movie.slug %}">Delete</a>

            </div>
          </div>

        <!-- Status Widget -->
        <div class="card my-4">
          <h5 class="card-header">Status: </h5>
          <div class="card-body" id="cardStatus">
            {% if movie.rented == False %}
            <div class="d-flex justify-content-between">
                <h4>Movie availlable </h4>
                <form class="formRent" id="formRent" action="." method="post">{% csrf_token %}
                    <input type="hidden" name="customer_id" value="{{user.id}}">
                    <input type="hidden" name="movie_id" value="{{movie.id}}">
                    <button type="button" id="btnRentForm" name="btnRentForm">Rent</button>
                </form>
            </div>
            {% else %}
            <h4>Movie Rent </h4>
            {% endif %}
          </div>
        </div>

        <img class="img-fluid" src="{{ movie.picture.url }}" alt="{{movie.slug}}">


        <!-- Categories Widget -->
        <div class="card my-4">
          <h5 class="card-header">Categories</h5>
          <div class="card-body">
            <div class="row">
              <div class="col-lg-6">
                <ul class="list-unstyled mb-0">
                    <li><a href="#"> {{movie.genre}} </a></li>
                </ul>
              </div>
            </div>
          </div>
        </div>



      </div>

    </div>
    <!-- /.row -->

    {% block script %}


        $(document).ready(function(){

            $('#btnRentForm').click(function () {
                $.ajax({
                    type: "POST",
                    url: "{% url 'rent_movie' movie.slug%}",
                    dataType: "json",
                    data: $("#formRent").serialize(),
                    success: function(response) {
                        $('#cardStatus').html('<h4>Movie Rent </h4>')
                        console.log("plop")
                    }
                })
            })
        })

    {% endblock %}


{% endblock %}
